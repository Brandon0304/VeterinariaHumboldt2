{
    "info": {
        "_postman_id": "veterinaria-api-collection-pruebas",
        "name": "Sistema Clínico Veterinario - Plan de Pruebas",
        "description": "Colección alineada al plan de pruebas (CP-RF1...CP-RF11) para el Sistema Clínico Veterinario.",
        "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
    },
    "item": [
        {
            "name": "RF1 - Gestión de Usuarios y Autenticación",
            "item": [
                {
                    "name": "[CP-RF1-001] Registro Veterinario exitoso",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"username\": \"vet_prueba_001\",\n    \"password\": \"Password123!\",\n    \"email\": \"vet001@clinica.com\",\n    \"nombre\": \"Dr. Juan\",\n    \"apellido\": \"Veterinario\",\n    \"rol\": \"VETERINARIO\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/auth/register",
                            "host": ["{{base_url}}"],
                            "path": ["auth", "register"]
                        },
                        "description": "Registra un nuevo veterinario exitosamente. El campo 'rol' debe ser 'VETERINARIO'."
                    },
                    "response": [],
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test(\"Respuesta exitosa\", function () {",
                                    "    pm.expect(pm.response.code).to.be.oneOf([200,201]);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "[CP-RF1-002] Registro rechazado por correo duplicado",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"username\": \"vet_duplicado\",\n    \"password\": \"Password123!\",\n    \"email\": \"vet001@clinica.com\",\n    \"nombre\": \"Dr. Duplicado\",\n    \"apellido\": \"Test\",\n    \"rol\": \"VETERINARIO\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/auth/register",
                            "host": ["{{base_url}}"],
                            "path": ["auth", "register"]
                        },
                        "description": "Intenta registrar un usuario con un correo que ya existe. Debe fallar con error 400 o 409."
                    },
                    "response": [],
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test(\"Debe fallar por correo duplicado\", function () {",
                                    "    pm.expect(pm.response.code).to.be.oneOf([400,409]);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "[CP-RF1-003] Registro rechazado por contraseña corta",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"username\": \"vet_password_corta\",\n    \"password\": \"12345\",\n    \"email\": \"vet_corta@clinica.com\",\n    \"nombre\": \"Dr. Test\",\n    \"apellido\": \"Password\",\n    \"rol\": \"VETERINARIO\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/auth/register",
                            "host": ["{{base_url}}"],
                            "path": ["auth", "register"]
                        },
                        "description": "Intenta registrar un usuario con contraseña menor a 8 caracteres. Debe fallar con error 400 o 422."
                    },
                    "response": [],
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test(\"Debe fallar por contraseña insegura\", function () {",
                                    "    pm.expect(pm.response.code).to.be.oneOf([400,422]);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "[CP-RF1-004] Login exitoso",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"username\": \"vet_prueba_001\",\n    \"password\": \"Password123!\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/auth/login",
                            "host": ["{{base_url}}"],
                            "path": ["auth", "login"]
                        },
                        "description": "Autentica un usuario con credenciales válidas. El token se guarda automáticamente en las variables."
                    },
                    "response": [],
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test(\"Login exitoso retorna 200\", function () {",
                                    "    pm.expect(pm.response.code).to.eql(200);",
                                    "});",
                                    "var res = pm.response.json();",
                                    "if (res.data && res.data.token) {",
                                    "    pm.environment.set(\"token\", res.data.token);",
                                    "    pm.environment.set(\"tokenType\", res.data.type);",
                                    "}"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "[CP-RF1-005] Login fallido (credenciales incorrectas)",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"username\": \"vet_prueba_001\",\n    \"password\": \"PasswordIncorrecta123!\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/auth/login",
                            "host": ["{{base_url}}"],
                            "path": ["auth", "login"]
                        },
                        "description": "Intenta autenticar con credenciales incorrectas. Debe fallar con error 400, 401 o 403."
                    },
                    "response": [],
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test(\"Login fallido retorna 400/401/403\", function () {",
                                    "    pm.expect(pm.response.code).to.be.oneOf([400,401,403]);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "CP-RF1-006 - Permisos por rol",
                    "item": [
                        {
                            "name": "[CP-RF1-006] Listar usuarios como ADMIN",
                            "request": {
                                "method": "GET",
                                "header": [
                                    {
                                        "key": "Authorization",
                                        "value": "{{tokenType}} {{token}}"
                                    }
                                ],
                                "url": {
                                    "raw": "{{base_url}}/usuarios",
                                    "host": ["{{base_url}}"],
                                    "path": ["usuarios"]
                                },
                                "description": "Lista todos los usuarios. Requiere autenticación. Solo ADMIN debería tener acceso completo."
                            },
                            "response": [],
                            "event": [
                                {
                                    "listen": "test",
                                    "script": {
                                        "type": "text/javascript",
                                        "exec": [
                                            "pm.test(\"Admin puede listar usuarios\", function () {",
                                            "    pm.expect(pm.response.code).to.eql(200);",
                                            "});"
                                        ]
                                    }
                                }
                            ]
                        },
                        {
                            "name": "[CP-RF1-006] Listar usuarios como rol sin permiso",
                            "request": {
                                "method": "GET",
                                "header": [
                                    {
                                        "key": "Authorization",
                                        "value": "{{tokenType}} {{token}}"
                                    }
                                ],
                                "url": {
                                    "raw": "{{base_url}}/usuarios",
                                    "host": ["{{base_url}}"],
                                    "path": ["usuarios"]
                                },
                                "description": "Intenta listar usuarios con un rol que no tiene permisos. Debe fallar con 401 o 403."
                            },
                            "response": [],
                            "event": [
                                {
                                    "listen": "test",
                                    "script": {
                                        "type": "text/javascript",
                                        "exec": [
                                            "pm.test(\"Debe denegar acceso a rol no ADMIN\", function () {",
                                            "    pm.expect(pm.response.code).to.be.oneOf([401,403]);",
                                            "});"
                                        ]
                                    }
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "name": "RF2 - Gestión de Inventario",
            "item": [
                {
                    "name": "[CP-RF2-001] Registrar entrada de producto nuevo",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "Authorization",
                                "value": "{{tokenType}} {{token}}"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"productoId\": {{producto_id}},\n    \"cantidad\": 50,\n    \"proveedorId\": {{proveedor_id}},\n    \"referencia\": \"OC-2025-001\",\n    \"usuarioId\": {{usuario_id}}\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/movimientos-inventario/entrada",
                            "host": ["{{base_url}}"],
                            "path": ["movimientos-inventario", "entrada"]
                        },
                        "description": "Registra una entrada de inventario para un producto existente. Si el producto no existe, primero debe crearse con POST /productos."
                    },
                    "response": [],
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test(\"Respuesta exitosa\", function () {",
                                    "    pm.expect(pm.response.code).to.be.oneOf([200,201]);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "[CP-RF2-002] Registrar salida de producto con actualización de stock",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "Authorization",
                                "value": "{{tokenType}} {{token}}"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"productoId\": {{producto_id}},\n    \"cantidad\": 10,\n    \"referencia\": \"CONSUMO-CONSULTA-001\",\n    \"usuarioId\": {{usuario_id}}\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/movimientos-inventario/salida",
                            "host": ["{{base_url}}"],
                            "path": ["movimientos-inventario", "salida"]
                        },
                        "description": "Registra una salida de inventario y actualiza el stock del producto. El producto debe tener stock suficiente."
                    },
                    "response": [],
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test(\"Respuesta exitosa\", function () {",
                                    "    pm.expect(pm.response.code).to.be.oneOf([200,201]);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "[CP-RF2-003] Listar productos con stock bajo",
                    "request": {
                        "method": "GET",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "{{tokenType}} {{token}}"
                            }
                        ],
                        "url": {
                            "raw": "{{base_url}}/productos/stock-bajo?nivelStock=10",
                            "host": ["{{base_url}}"],
                            "path": ["productos", "stock-bajo"],
                            "query": [
                                {
                                    "key": "nivelStock",
                                    "value": "10"
                                }
                            ]
                        },
                        "description": "Obtiene la lista de productos con stock menor o igual al nivel especificado."
                    },
                    "response": [],
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test(\"Respuesta exitosa\", function () {",
                                    "    pm.expect(pm.response.code).to.be.oneOf([200,201]);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "[CP-RF2-004] Rechazar salida cuando excede stock",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "Authorization",
                                "value": "{{tokenType}} {{token}}"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"productoId\": {{producto_id}},\n    \"cantidad\": 99999,\n    \"referencia\": \"CONSUMO-TEST\",\n    \"usuarioId\": {{usuario_id}}\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/movimientos-inventario/salida",
                            "host": ["{{base_url}}"],
                            "path": ["movimientos-inventario", "salida"]
                        },
                        "description": "Intenta registrar una salida con cantidad mayor al stock disponible. Debe fallar con error 400 o 409."
                    },
                    "response": [],
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test(\"Salida rechazada por stock insuficiente\", function () {",
                                    "    pm.expect(pm.response.code).to.be.oneOf([400,409]);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "[CP-RF2-005] Rechazar producto con precio no positivo",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "Authorization",
                                "value": "{{tokenType}} {{token}}"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"sku\": \"PROD-TEST-001\",\n    \"nombre\": \"Producto Test\",\n    \"descripcion\": \"Producto de prueba con precio inválido\",\n    \"tipo\": \"MEDICAMENTO\",\n    \"precioUnitario\": -10.50,\n    \"um\": \"unidad\",\n    \"stock\": 0\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/productos",
                            "host": ["{{base_url}}"],
                            "path": ["productos"]
                        },
                        "description": "Intenta crear un producto con precio negativo. Debe fallar con error 400 o 422."
                    },
                    "response": [],
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test(\"Debe fallar por precio no válido\", function () {",
                                    "    pm.expect(pm.response.code).to.be.oneOf([400,422]);",
                                    "});"
                                ]
                            }
                        }
                    ]
                }
            ]
        },
        {
            "name": "RF3 - Gestión de Pacientes",
            "item": [
                {
                    "name": "[CP-RF3-001] Registro exitoso de paciente canino",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "Authorization",
                                "value": "{{tokenType}} {{token}}"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"nombre\": \"Max\",\n    \"especie\": \"perro\",\n    \"raza\": \"Beagle\",\n    \"fechaNacimiento\": \"2020-05-15\",\n    \"sexo\": \"Macho\",\n    \"pesoKg\": 12.5,\n    \"estadoSalud\": \"Saludable\",\n    \"clienteId\": {{cliente_id}}\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/pacientes",
                            "host": ["{{base_url}}"],
                            "path": ["pacientes"]
                        },
                        "description": "Registra un nuevo paciente canino exitosamente. Se crea automáticamente su historia clínica."
                    },
                    "response": [],
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test(\"Respuesta exitosa\", function () {",
                                    "    pm.expect(pm.response.code).to.be.oneOf([200,201]);",
                                    "});",
                                    "if (pm.response.code === 200 || pm.response.code === 201) {",
                                    "    var res = pm.response.json();",
                                    "    if (res.data && res.data.idPaciente) {",
                                    "        pm.environment.set(\"paciente_id\", res.data.idPaciente);",
                                    "    }",
                                    "}"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "[CP-RF3-002] Rechazo por edad inválida",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "Authorization",
                                "value": "{{tokenType}} {{token}}"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"nombre\": \"Test\",\n    \"especie\": \"perro\",\n    \"raza\": \"Beagle\",\n    \"fechaNacimiento\": \"2026-12-31\",\n    \"sexo\": \"Macho\",\n    \"pesoKg\": 10.0,\n    \"estadoSalud\": \"Saludable\",\n    \"clienteId\": {{cliente_id}}\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/pacientes",
                            "host": ["{{base_url}}"],
                            "path": ["pacientes"]
                        },
                        "description": "Intenta registrar un paciente con fecha de nacimiento futura. Debe fallar con error 400 o 422."
                    },
                    "response": [],
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test(\"Debe fallar por edad inválida\", function () {",
                                    "    pm.expect(pm.response.code).to.be.oneOf([400,422]);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "[CP-RF3-003] Rechazo por peso negativo o cero",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "Authorization",
                                "value": "{{tokenType}} {{token}}"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"nombre\": \"Test\",\n    \"especie\": \"perro\",\n    \"raza\": \"Beagle\",\n    \"fechaNacimiento\": \"2020-05-15\",\n    \"sexo\": \"Macho\",\n    \"pesoKg\": -5.0,\n    \"estadoSalud\": \"Saludable\",\n    \"clienteId\": {{cliente_id}}\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/pacientes",
                            "host": ["{{base_url}}"],
                            "path": ["pacientes"]
                        },
                        "description": "Intenta registrar un paciente con peso negativo o cero. Debe fallar con error 400 o 422."
                    },
                    "response": [],
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test(\"Debe fallar por peso inválido\", function () {",
                                    "    pm.expect(pm.response.code).to.be.oneOf([400,422]);",
                                    "});"
                                ]
                            }
                        }
                    ]
                }
            ]
        },
        {
            "name": "RF4 - Historias Clínicas",
            "item": [
                {
                    "name": "[CP-RF4-001] Crear registro en historia clínica",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "Authorization",
                                "value": "{{tokenType}} {{token}}"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"fecha\": \"2025-03-15T10:30:00\",\n    \"motivo\": \"Control de rutina\",\n    \"diagnostico\": \"Paciente en buen estado de salud\",\n    \"signosVitales\": {\n        \"temperatura\": 38.5,\n        \"frecuencia_cardiaca\": 90,\n        \"frecuencia_respiratoria\": 20\n    },\n    \"tratamiento\": \"Ninguno requerido\",\n    \"veterinarioId\": {{veterinario_id}}\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/historias-clinicas/{{historia_id}}/registros",
                            "host": ["{{base_url}}"],
                            "path": ["historias-clinicas", "{{historia_id}}", "registros"]
                        },
                        "description": "Crea un nuevo registro médico en la historia clínica del paciente."
                    },
                    "response": [],
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test(\"Respuesta exitosa\", function () {",
                                    "    pm.expect(pm.response.code).to.be.oneOf([200,201]);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "[CP-RF4-002] Registro de signos vitales en rango válido",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "Authorization",
                                "value": "{{tokenType}} {{token}}"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"fecha\": \"2025-03-15T10:30:00\",\n    \"motivo\": \"Control de signos vitales\",\n    \"diagnostico\": \"Signos vitales normales\",\n    \"signosVitales\": {\n        \"temperatura\": 38.2,\n        \"frecuencia_cardiaca\": 85,\n        \"frecuencia_respiratoria\": 18,\n        \"presion_arterial\": \"120/80\"\n    },\n    \"tratamiento\": \"Observación\",\n    \"veterinarioId\": {{veterinario_id}}\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/historias-clinicas/{{historia_id}}/registros",
                            "host": ["{{base_url}}"],
                            "path": ["historias-clinicas", "{{historia_id}}", "registros"]
                        },
                        "description": "Registra signos vitales dentro de rangos válidos para un perro o gato."
                    },
                    "response": [],
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test(\"Respuesta exitosa\", function () {",
                                    "    pm.expect(pm.response.code).to.be.oneOf([200,201]);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "[CP-RF4-003] Rechazo por temperatura fuera de rango",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "Authorization",
                                "value": "{{tokenType}} {{token}}"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"fecha\": \"2025-03-15T10:30:00\",\n    \"motivo\": \"Control de temperatura\",\n    \"diagnostico\": \"Temperatura anormal\",\n    \"signosVitales\": {\n        \"temperatura\": 50.0,\n        \"frecuencia_cardiaca\": 90\n    },\n    \"tratamiento\": \"Revisar medición\",\n    \"veterinarioId\": {{veterinario_id}}\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/historias-clinicas/{{historia_id}}/registros",
                            "host": ["{{base_url}}"],
                            "path": ["historias-clinicas", "{{historia_id}}", "registros"]
                        },
                        "description": "Intenta registrar una temperatura fuera del rango válido (normalmente 35-42°C). Nota: La validación puede estar en el frontend o en lógica de negocio."
                    },
                    "response": [],
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test(\"Debe fallar por temperatura fuera de rango\", function () {",
                                    "    pm.expect(pm.response.code).to.be.oneOf([400,422]);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "[CP-RF4-004] Registro con insumos que descuentan inventario",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "Authorization",
                                "value": "{{tokenType}} {{token}}"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"fecha\": \"2025-03-15T10:30:00\",\n    \"motivo\": \"Aplicación de medicamento\",\n    \"diagnostico\": \"Tratamiento con antibiótico\",\n    \"signosVitales\": {\n        \"temperatura\": 38.5\n    },\n    \"tratamiento\": \"Antibiótico por 7 días\",\n    \"veterinarioId\": {{veterinario_id}},\n    \"insumosUsados\": [\n        {\n            \"productoId\": {{producto_id}},\n            \"cantidad\": 2\n        }\n    ]\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/historias-clinicas/{{historia_id}}/registros",
                            "host": ["{{base_url}}"],
                            "path": ["historias-clinicas", "{{historia_id}}", "registros"]
                        },
                        "description": "Crea un registro médico que consume insumos del inventario. Los insumos deben descontarse del stock."
                    },
                    "response": [],
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test(\"Respuesta exitosa\", function () {",
                                    "    pm.expect(pm.response.code).to.be.oneOf([200,201]);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "[CP-RF4-005] Obtener historia clínica por paciente",
                    "request": {
                        "method": "GET",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "{{tokenType}} {{token}}"
                            }
                        ],
                        "url": {
                            "raw": "{{base_url}}/historias-clinicas/paciente/{{paciente_id}}",
                            "host": ["{{base_url}}"],
                            "path": ["historias-clinicas", "paciente", "{{paciente_id}}"]
                        },
                        "description": "Obtiene la historia clínica completa de un paciente, incluyendo todos sus registros médicos."
                    },
                    "response": [],
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test(\"Respuesta exitosa\", function () {",
                                    "    pm.expect(pm.response.code).to.be.oneOf([200,201]);",
                                    "});"
                                ]
                            }
                        }
                    ]
                }
            ]
        },
        {
            "name": "RF8 - Citas y Triage",
            "item": [
                {
                    "name": "[CP-RF8-001] Registro exitoso de cita programada",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "Authorization",
                                "value": "{{tokenType}} {{token}}"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"pacienteId\": {{paciente_id}},\n    \"veterinarioId\": {{veterinario_id}},\n    \"fechaHora\": \"2025-12-15T09:30:00\",\n    \"tipoServicio\": \"Consulta General\",\n    \"motivo\": \"Chequeo anual y vacunas\",\n    \"triageNivel\": \"MEDIA\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/citas",
                            "host": ["{{base_url}}"],
                            "path": ["citas"]
                        },
                        "description": "Programa una nueva cita médica exitosamente. La fecha debe estar en el futuro."
                    },
                    "response": [],
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test(\"Respuesta exitosa\", function () {",
                                    "    pm.expect(pm.response.code).to.be.oneOf([200,201]);",
                                    "});",
                                    "if (pm.response.code === 200 || pm.response.code === 201) {",
                                    "    var res = pm.response.json();",
                                    "    if (res.data && res.data.idCita) {",
                                    "        pm.environment.set(\"cita_id\", res.data.idCita);",
                                    "    }",
                                    "}"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "[CP-RF8-002] Rechazo de cita duplicada para mismo veterinario y horario",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "Authorization",
                                "value": "{{tokenType}} {{token}}"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"pacienteId\": {{paciente_id}},\n    \"veterinarioId\": {{veterinario_id}},\n    \"fechaHora\": \"2025-12-15T09:30:00\",\n    \"tipoServicio\": \"Consulta General\",\n    \"motivo\": \"Cita duplicada\",\n    \"triageNivel\": \"MEDIA\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/citas",
                            "host": ["{{base_url}}"],
                            "path": ["citas"]
                        },
                        "description": "Intenta programar una cita con el mismo veterinario y horario que una cita existente. Debe fallar con error 400 o 409."
                    },
                    "response": [],
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test(\"Debe fallar por cita duplicada\", function () {",
                                    "    pm.expect(pm.response.code).to.be.oneOf([400,409]);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "[CP-RF8-003] Rechazo de cita para paciente fallecido",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "Authorization",
                                "value": "{{tokenType}} {{token}}"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"pacienteId\": {{paciente_id}},\n    \"veterinarioId\": {{veterinario_id}},\n    \"fechaHora\": \"2025-12-15T10:00:00\",\n    \"tipoServicio\": \"Consulta General\",\n    \"motivo\": \"Cita para paciente fallecido\",\n    \"triageNivel\": \"MEDIA\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/citas",
                            "host": ["{{base_url}}"],
                            "path": ["citas"]
                        },
                        "description": "Intenta programar una cita para un paciente con estado 'fallecido'. Debe fallar con error 400, 409 o 422. Nota: Requiere que el paciente tenga estadoSalud='Fallecido'."
                    },
                    "response": [],
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test(\"Debe fallar para paciente fallecido\", function () {",
                                    "    pm.expect(pm.response.code).to.be.oneOf([400,409,422]);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "[CP-RF8-004] Registro de cita urgente con triage ALTA",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "Authorization",
                                "value": "{{tokenType}} {{token}}"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"pacienteId\": {{paciente_id}},\n    \"veterinarioId\": {{veterinario_id}},\n    \"fechaHora\": \"2025-12-15T14:00:00\",\n    \"tipoServicio\": \"Urgencia\",\n    \"motivo\": \"Emergencia médica\",\n    \"triageNivel\": \"ALTA\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/citas",
                            "host": ["{{base_url}}"],
                            "path": ["citas"]
                        },
                        "description": "Programa una cita urgente con nivel de triage ALTA."
                    },
                    "response": [],
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test(\"Respuesta exitosa\", function () {",
                                    "    pm.expect(pm.response.code).to.be.oneOf([200,201]);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "[CP-RF8-005] Envío de notificación al confirmar cita",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "Authorization",
                                "value": "{{tokenType}} {{token}}"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"destinatarioId\": {{cliente_id}},\n    \"tipo\": \"CITA_CONFIRMADA\",\n    \"titulo\": \"Cita confirmada\",\n    \"mensaje\": \"Su cita ha sido confirmada para el 2025-12-15 a las 09:30\",\n    \"canales\": [\"EMAIL\", \"APP\"],\n    \"metadatos\": {\n        \"citaId\": {{cita_id}},\n        \"fechaHora\": \"2025-12-15T09:30:00\"\n    }\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/notificaciones/enviar",
                            "host": ["{{base_url}}"],
                            "path": ["notificaciones", "enviar"]
                        },
                        "description": "Envía una notificación al cliente cuando se confirma una cita."
                    },
                    "response": [],
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test(\"Respuesta exitosa\", function () {",
                                    "    pm.expect(pm.response.code).to.be.oneOf([200,201]);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "[CP-RF8-006] Rechazo de cita en fecha pasada",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "Authorization",
                                "value": "{{tokenType}} {{token}}"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"pacienteId\": {{paciente_id}},\n    \"veterinarioId\": {{veterinario_id}},\n    \"fechaHora\": \"2020-01-01T09:30:00\",\n    \"tipoServicio\": \"Consulta General\",\n    \"motivo\": \"Cita en el pasado\",\n    \"triageNivel\": \"MEDIA\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/citas",
                            "host": ["{{base_url}}"],
                            "path": ["citas"]
                        },
                        "description": "Intenta programar una cita con fecha en el pasado. Debe fallar con error 400 o 422."
                    },
                    "response": [],
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test(\"Debe fallar por fecha en el pasado\", function () {",
                                    "    pm.expect(pm.response.code).to.be.oneOf([400,422]);",
                                    "});"
                                ]
                            }
                        }
                    ]
                }
            ]
        },
        {
            "name": "RF9 - Pagos y Facturación",
            "item": [
                {
                    "name": "[CP-RF9-001] Generación de factura después de consulta",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "Authorization",
                                "value": "{{tokenType}} {{token}}"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"clienteId\": {{cliente_id}},\n    \"total\": 150000.00,\n    \"formaPago\": \"EFECTIVO\",\n    \"contenido\": {\n        \"items\": [\n            {\n                \"descripcion\": \"Consulta general\",\n                \"cantidad\": 1,\n                \"precioUnitario\": 100000.00,\n                \"subtotal\": 100000.00\n            },\n            {\n                \"descripcion\": \"Vacunación\",\n                \"cantidad\": 1,\n                \"precioUnitario\": 50000.00,\n                \"subtotal\": 50000.00\n            }\n        ],\n        \"subtotal\": 150000.00,\n        \"iva\": 0.00,\n        \"total\": 150000.00\n    }\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/facturas",
                            "host": ["{{base_url}}"],
                            "path": ["facturas"]
                        },
                        "description": "Genera una factura después de una consulta médica. El total debe ser mayor a cero."
                    },
                    "response": [],
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test(\"Respuesta exitosa\", function () {",
                                    "    pm.expect(pm.response.code).to.be.oneOf([200,201]);",
                                    "});",
                                    "if (pm.response.code === 200 || pm.response.code === 201) {",
                                    "    var res = pm.response.json();",
                                    "    if (res.data && res.data.idFactura) {",
                                    "        pm.environment.set(\"factura_id\", res.data.idFactura);",
                                    "    }",
                                    "}"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "[CP-RF9-002] Factura con cálculo correcto de total",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "Authorization",
                                "value": "{{tokenType}} {{token}}"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"clienteId\": {{cliente_id}},\n    \"total\": 250000.00,\n    \"formaPago\": \"TARJETA\",\n    \"contenido\": {\n        \"items\": [\n            {\n                \"descripcion\": \"Consulta especializada\",\n                \"cantidad\": 1,\n                \"precioUnitario\": 150000.00,\n                \"subtotal\": 150000.00\n            },\n            {\n                \"descripcion\": \"Radiografía\",\n                \"cantidad\": 1,\n                \"precioUnitario\": 100000.00,\n                \"subtotal\": 100000.00\n            }\n        ],\n        \"subtotal\": 250000.00,\n        \"iva\": 0.00,\n        \"total\": 250000.00\n    }\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/facturas",
                            "host": ["{{base_url}}"],
                            "path": ["facturas"]
                        },
                        "description": "Genera una factura verificando que el total calculado sea correcto (suma de items)."
                    },
                    "response": [],
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test(\"Respuesta exitosa\", function () {",
                                    "    pm.expect(pm.response.code).to.be.oneOf([200,201]);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "[CP-RF9-003] Registro de pago en efectivo",
                    "request": {
                        "method": "PUT",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "Authorization",
                                "value": "{{tokenType}} {{token}}"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"formaPago\": \"EFECTIVO\",\n    \"montoPagado\": 150000.00\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/facturas/{{factura_id}}/pagar",
                            "host": ["{{base_url}}"],
                            "path": ["facturas", "{{factura_id}}", "pagar"]
                        },
                        "description": "Registra el pago de una factura en efectivo. Actualiza el estado de la factura a PAGADA."
                    },
                    "response": [],
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test(\"Respuesta exitosa\", function () {",
                                    "    pm.expect(pm.response.code).to.be.oneOf([200,201]);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "[CP-RF9-004] Rechazo de factura con total cero o negativo",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "Authorization",
                                "value": "{{tokenType}} {{token}}"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"clienteId\": {{cliente_id}},\n    \"total\": -100.00,\n    \"formaPago\": \"EFECTIVO\",\n    \"contenido\": {\n        \"items\": [],\n        \"subtotal\": 0.00,\n        \"iva\": 0.00,\n        \"total\": -100.00\n    }\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/facturas",
                            "host": ["{{base_url}}"],
                            "path": ["facturas"]
                        },
                        "description": "Intenta crear una factura con total negativo o cero. Debe fallar con error 400 o 422."
                    },
                    "response": [],
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test(\"Debe fallar por total inválido\", function () {",
                                    "    pm.expect(pm.response.code).to.be.oneOf([400,422]);",
                                    "});"
                                ]
                            }
                        }
                    ]
                }
            ]
        },
        {
            "name": "RF10 - Reportes y Estadísticas",
            "item": [
                {
                    "name": "[CP-RF10-001] Generar reporte de pacientes atendidos en un mes",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "Authorization",
                                "value": "{{tokenType}} {{token}}"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"tipoReporte\": \"PACIENTES_ATENDIDOS\",\n    \"fechaInicio\": \"2025-03-01\",\n    \"fechaFin\": \"2025-03-31\",\n    \"parametros\": {\n        \"agruparPor\": \"especie\",\n        \"incluirDetalles\": true\n    }\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/reportes/generar",
                            "host": ["{{base_url}}"],
                            "path": ["reportes", "generar"]
                        },
                        "description": "Genera un reporte de pacientes atendidos durante un mes específico."
                    },
                    "response": [],
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test(\"Respuesta exitosa\", function () {",
                                    "    pm.expect(pm.response.code).to.be.oneOf([200,201]);",
                                    "});",
                                    "if (pm.response.code === 200 || pm.response.code === 201) {",
                                    "    var res = pm.response.json();",
                                    "    if (res.data && res.data.idReporte) {",
                                    "        pm.environment.set(\"reporte_id\", res.data.idReporte);",
                                    "    }",
                                    "}"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "[CP-RF10-002] Generar reporte de inventario con stock actual",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "Authorization",
                                "value": "{{tokenType}} {{token}}"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"tipoReporte\": \"INVENTARIO\",\n    \"fechaInicio\": null,\n    \"fechaFin\": null,\n    \"parametros\": {\n        \"incluirStockBajo\": true,\n        \"nivelStockMinimo\": 10\n    }\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/reportes/generar",
                            "host": ["{{base_url}}"],
                            "path": ["reportes", "generar"]
                        },
                        "description": "Genera un reporte del inventario actual, incluyendo productos con stock bajo."
                    },
                    "response": [],
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test(\"Respuesta exitosa\", function () {",
                                    "    pm.expect(pm.response.code).to.be.oneOf([200,201]);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "[CP-RF10-003] Exportar reporte en PDF",
                    "request": {
                        "method": "GET",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "{{tokenType}} {{token}}"
                            }
                        ],
                        "url": {
                            "raw": "{{base_url}}/reportes/{{reporte_id}}/exportar-pdf",
                            "host": ["{{base_url}}"],
                            "path": ["reportes", "{{reporte_id}}", "exportar-pdf"]
                        },
                        "description": "Exporta un reporte generado previamente en formato PDF."
                    },
                    "response": [],
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test(\"Respuesta exitosa\", function () {",
                                    "    pm.expect(pm.response.code).to.be.oneOf([200,201]);",
                                    "});"
                                ]
                            }
                        }
                    ]
                }
            ]
        },
        {
            "name": "RF11 - Vacunación y Desparasitación",
            "item": [
                {
                    "name": "[CP-RF11-001] Registro de vacuna con próxima dosis",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "Authorization",
                                "value": "{{tokenType}} {{token}}"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"pacienteId\": {{paciente_id}},\n    \"tipoVacuna\": \"Rabia\",\n    \"fechaAplicacion\": \"2025-03-10\",\n    \"proximaDosis\": \"2026-03-10\",\n    \"veterinarioId\": {{veterinario_id}}\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/vacunaciones",
                            "host": ["{{base_url}}"],
                            "path": ["vacunaciones"]
                        },
                        "description": "Registra una vacunación con la fecha de próxima dosis programada."
                    },
                    "response": [],
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test(\"Respuesta exitosa\", function () {",
                                    "    pm.expect(pm.response.code).to.be.oneOf([200,201]);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "[CP-RF11-002] Rechazo de vacuna por no cumplir edad mínima",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "Authorization",
                                "value": "{{tokenType}} {{token}}"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"pacienteId\": {{paciente_id}},\n    \"tipoVacuna\": \"Rabia\",\n    \"fechaAplicacion\": \"2025-03-10\",\n    \"proximaDosis\": \"2026-03-10\",\n    \"veterinarioId\": {{veterinario_id}}\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/vacunaciones",
                            "host": ["{{base_url}}"],
                            "path": ["vacunaciones"]
                        },
                        "description": "Intenta vacunar un paciente que no cumple la edad mínima requerida. Nota: Esta validación puede requerir lógica de negocio adicional basada en la fecha de nacimiento del paciente."
                    },
                    "response": [],
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test(\"Debe fallar por edad no permitida\", function () {",
                                    "    pm.expect(pm.response.code).to.be.oneOf([400,422]);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "[CP-RF11-003] Obtener vacunaciones próximas a vencer",
                    "request": {
                        "method": "GET",
                        "header": [
                            {
                                "key": "Authorization",
                                "value": "{{tokenType}} {{token}}"
                            }
                        ],
                        "url": {
                            "raw": "{{base_url}}/vacunaciones/pendientes?dias=30",
                            "host": ["{{base_url}}"],
                            "path": ["vacunaciones", "pendientes"],
                            "query": [
                                {
                                    "key": "dias",
                                    "value": "30"
                                }
                            ]
                        },
                        "description": "Obtiene la lista de vacunaciones que están próximas a vencer (dentro de los próximos 30 días)."
                    },
                    "response": [],
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test(\"Respuesta exitosa\", function () {",
                                    "    pm.expect(pm.response.code).to.be.oneOf([200,201]);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "[CP-RF11-004] Rechazo de vacuna a paciente fallecido",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "Authorization",
                                "value": "{{tokenType}} {{token}}"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"pacienteId\": {{paciente_id}},\n    \"tipoVacuna\": \"Rabia\",\n    \"fechaAplicacion\": \"2025-03-10\",\n    \"proximaDosis\": \"2026-03-10\",\n    \"veterinarioId\": {{veterinario_id}}\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/vacunaciones",
                            "host": ["{{base_url}}"],
                            "path": ["vacunaciones"]
                        },
                        "description": "Intenta vacunar un paciente con estado 'fallecido'. Debe fallar con error 400, 409 o 422. Nota: Requiere que el paciente tenga estadoSalud='Fallecido'."
                    },
                    "response": [],
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test(\"Debe fallar para paciente fallecido\", function () {",
                                    "    pm.expect(pm.response.code).to.be.oneOf([400,409,422]);",
                                    "});"
                                ]
                            }
                        }
                    ]
                }
            ]
        },
        {
            "name": "RF7 - Configuración del Sistema",
            "item": [
                {
                    "name": "[CP-RF7-001] Actualizar parámetro general del sistema",
                    "request": {
                        "method": "PUT",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "Authorization",
                                "value": "{{tokenType}} {{token}}"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"valor\": \"Clínica Veterinaria San Rafael\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/configuracion/parametros/clinica.nombre",
                            "host": ["{{base_url}}"],
                            "path": ["configuracion", "parametros", "clinica.nombre"]
                        },
                        "description": "Actualiza un parámetro de configuración del sistema (nombre de la clínica)."
                    },
                    "response": [],
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test(\"Respuesta exitosa\", function () {",
                                    "    pm.expect(pm.response.code).to.be.oneOf([200,201]);",
                                    "});"
                                ]
                            }
                        }
                    ]
                },
                {
                    "name": "[CP-RF7-002] Activar recordatorios automáticos por configuración",
                    "request": {
                        "method": "PUT",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            },
                            {
                                "key": "Authorization",
                                "value": "{{tokenType}} {{token}}"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"valor\": \"true\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/configuracion/parametros/notificaciones.recordatorios.enabled",
                            "host": ["{{base_url}}"],
                            "path": ["configuracion", "parametros", "notificaciones.recordatorios.enabled"]
                        },
                        "description": "Activa los recordatorios automáticos mediante la configuración del sistema."
                    },
                    "response": [],
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "type": "text/javascript",
                                "exec": [
                                    "pm.test(\"Respuesta exitosa\", function () {",
                                    "    pm.expect(pm.response.code).to.be.oneOf([200,201]);",
                                    "});"
                                ]
                            }
                        }
                    ]
                }
            ]
        }
    ],
    "variable": [
        {
            "key": "base_url",
            "value": "http://localhost:8080/api",
            "type": "string"
        },
        {
            "key": "token",
            "value": "",
            "type": "string"
        },
        {
            "key": "tokenType",
            "value": "Bearer",
            "type": "string"
        },
        {
            "key": "cliente_id",
            "value": "1",
            "type": "string"
        },
        {
            "key": "paciente_id",
            "value": "1",
            "type": "string"
        },
        {
            "key": "usuario_id",
            "value": "1",
            "type": "string"
        },
        {
            "key": "veterinario_id",
            "value": "1",
            "type": "string"
        },
        {
            "key": "producto_id",
            "value": "1",
            "type": "string"
        },
        {
            "key": "cita_id",
            "value": "1",
            "type": "string"
        },
        {
            "key": "factura_id",
            "value": "1",
            "type": "string"
        },
        {
            "key": "historia_id",
            "value": "1",
            "type": "string"
        },
        {
            "key": "vacunacion_id",
            "value": "1",
            "type": "string"
        },
        {
            "key": "proveedor_id",
            "value": "1",
            "type": "string"
        },
        {
            "key": "reset_token",
            "value": "",
            "type": "string"
        },
        {
            "key": "servicio_prestado_id",
            "value": "1",
            "type": "string"
        },
        {
            "key": "reporte_id",
            "value": "1",
            "type": "string"
        }
    ]
}
